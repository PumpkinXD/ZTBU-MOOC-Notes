第四章 网络互联基础知识

4.1 网络连接基础技术

4.1.1 数据封装

一个局域网的数据帧中封装了6个地址：一对MAC地址，一对IP地址和一对port

数据分段的目的：便于数据出错重发和通讯线路的争用平衡

需要两个地址的原因：

MAC地址只是给主机地址编码，当网络更为复杂时，我们不仅需要知道目标主机的地址还要知道目标在哪个网络上，因此我们还需要目标所在网络的网络地址。IP地址包含有网络地址和主机地址

要完成数据的传输，需要三级寻址：

MAC地址：网段内寻址

IP地址：网间寻址

端口：应用程序寻址

当数据通过MAC地址和IP地址联合寻址到达目标主机后，目标需要把数据交给某个应用程序去处理（未记完）

4.1.2硬件地址（MAC地址）

Media Access Control ID 是一个6字节的地址码，每块主机网卡都有一个MAC地址

 高3个字节是生产厂家的企业编码OUI，低3个字节3A-07-BC是随机数；

由生产厂家固化在网卡芯片中

4.1.3 IP地址与MAC地址

IP地址与硬件地址是不同的地址

从层次的角度看

1. 硬件地址是数据链路层和物理层使用的地址
2. IP地址是网络层和以上各层使用的地址，是一种逻辑地址（由软件实现）

4.2.1 IPv4

1）表示

IPv4在机器中是以32位二进制代码存储的（32bits==4bytes）

其中每8位一组

每组用十进制数表示（此表示法称点分十进制），如：127.0.0.1（环回地址）

2)IP的分类

每个IPv4地址内部分为两部分,即网络号和主机号

网络号与主机号在IPv4中共32bits（==4bytes）

其中 若网络号占总地址空间小，则主机号部分占用即增加-->可容纳更多主机，即网络规模较大（反之同理）

为了便于管理，IPv4地址分为A，B，C，D，E五类





| IPv4地址类型 | 二进制固定最高位(x为网络位) | 二进制网络位 | 二进制主机位 | 地址范围                  | 最多 可容纳主机数 |
| ------------ | --------------------------- | ------------ | ------------ | ------------------------- | ----------------- |
| A            | 0b0XXXXXXX                  | 高8位        | 低24位       | 1.0.0.0~126.0.0.0         | (2E24)-2          |
| B            | 0b10...                     | 高16位       | 低16位       | 128.0.0.0~191.255.255.255 | (2E16)-2          |
| C            | 0b110...                    | 高24位       | 低8位        | 192.0.0.0~223.255.255.255 | 254               |
| D            | 0b1110...                   |              | (组播地址）  | 224.0.0.0~239.255.255.255 |                   |
| E            | 0b11110...                  |              | （保留地址） | 240.0.0.0~247.255.255.255 |                   |

特殊地址：

主机地址均为1的为直接广播地址

如对于192.168.10.0的C类网段，其广播地址为192.168.10.255

255.255.255.255为有限广播地址

127.0.0.1为本机回送地址（127.x.x.x为回送地址组）



组播地址(D类IP)

主要用于视频广播和视频点播系统，范围见表，其中224.0.0.1指所有主机，224.0.0.2指所有路由器

与广播地址不同的是 广播地址按主机的物理位置来划分各族，而组播地址则是指定一个特定的逻辑组，参与该组的计算机可能遍布整个Internet

环回地址/回送地址（127.x.x.x)

主要用于本地回路测试与本地机进程间通信，最常用的环回地址是本机回送地址127.0.0.1 localhost



私有地址

一般的IP有网络信息中心NIC统一管理并分配给申请的组织机构的，这类IP地址被称为公有地址，可通过它直接访问internet

而私有地址为非注册地址，专门为组织内部使用

| 私有地址类别 | 范围                            |
| ------------ | ------------------------------- |
| A            | 10.0.0.0~10.255.255.255         |
| B            | 172.16.0.0~172.31.255.255       |
| C            | 192.168.0.0~192.168.255.255.255 |

使用私有地址的私有网络由于不与外部互连，因而可能使用随意的IP地址。私有网络在接入Internet时，要使用地址转换（NAT），将私有地址转换成公用合法IP地址。

NAT（未记完）



特殊IP汇总

| 网络地址        | 主机地址（二进制） | 类型     | 用途         |
| --------------- | ------------------ | -------- | ------------ |
| 全0（二进制位） | 全0                | 本机     | 启动时使用   |
| 有网络号        | 全0                | 网络     | 标识网络     |
| 有网络号        | 全1                | 直接广播 | 专门网络广播 |
| 全1（二进制位） | 全1                | 有限广播 | 本地网络广播 |
| 127             | 任意               | 环回地址 | 回送         |

TCP/1P 另有的规定：

网络标识的第一字节不能全部为0。
主机标识部分不能全为0,也不能全为1。
0地址:即0.0.0.0泛指所有网,即指任意网络。
